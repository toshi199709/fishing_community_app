<!-- 🔽 投稿マップセクション -->
<section class="bg-dark text-white py-4">
  <div class="container text-center">
    <% if user_signed_in? %>
      <%= link_to "新規投稿する", new_post_path, class: "btn btn-success mb-3" %>
    <% else %>
      <p>投稿するにはログインが必要です</p>
    <% end %>

    <h2 class="mb-4">投稿マップ</h2>

    <!-- ✅ 丸型マップに修正 -->
    <div class="d-flex justify-content-center">
      <div id="index-map"
           style="height: 400px; width: 400px; border-radius: 50%; overflow: hidden;"
           data-posts='<%= raw @posts_with_location.map { |post|
             {
               id: post.id,
               latitude: post.latitude,
               longitude: post.longitude,
               image_url: url_for(post.image)
             }
           }.to_json %>'>
      </div>
    </div>
  </div>
</section>

<!-- 🔽 投稿スライダーセクション -->
<section class="bg-secondary text-white py-4">
  <div class="container">
    <h2 class="mb-3">投稿一覧</h2>

    <!-- ✅ 横スクロールスライダー -->
    <div class="d-flex overflow-auto gap-3 px-2 pb-3">
      <% @posts.each do |post| %>
        <div class="card bg-dark text-white flex-shrink-0" style="width: 260px; border-radius: 15px;">
          <% if post.image.attached? %>
            <%= image_tag post.image, class: "card-img-top", style: "height: 180px; object-fit: cover;" %>
          <% end %>
          <div class="card-body">
            <p class="card-text" style="font-size: 0.9rem;"><%= truncate(post.text, length: 50) %></p>
            <p class="card-text"><small class="text-muted">投稿者: <%= post.user.nickname %></small></p>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</section>
